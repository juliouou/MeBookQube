{"generator":"Code Snippets v3.9.3","date_created":"2026-01-19 13:12","snippets":[{"id":12,"name":"CarruselRandom","code":"add_shortcode( 'carrusel_libros', 'funcion_carrusel_v2_random' );\n\nfunction funcion_carrusel_v2_random( $atts ) {\n    global $wpdb;\n    \n    \/\/ Configuraci\u00f3n: A\u00f1adimos 'orden'\n    $a = shortcode_atts( array(\n        'tipo'   => 'recientes', \n        'cat'    => '',\n        'limite' => 8,\n        'orden'  => 'desc' \/\/ Puede ser 'desc' (nuevos) o 'random' (al azar)\n    ), $atts );\n\n    $sql = \"SELECT * FROM libros WHERE 1=1\";\n\n    \/\/ 1. FILTROS\n    if ( $a['tipo'] == 'baratos' ) {\n        $sql .= \" AND precio <= 15\";\n    } elseif ( $a['tipo'] == 'por_categoria' && !empty($a['cat']) ) {\n        \/\/ OJO: Usamos 'categorias' en plural, como corregimos antes\n        $sql .= $wpdb->prepare(\" AND categorias = %s\", $a['cat']);\n    }\n\n    \/\/ 2. ORDENAMIENTO (Aqu\u00ed est\u00e1 la magia)\n    if ( $a['orden'] == 'random' ) {\n        $sql .= \" ORDER BY RAND()\";\n    } else {\n        \/\/ Por defecto: orden por ID (del m\u00e1s nuevo al m\u00e1s viejo)\n        if ( $a['tipo'] == 'baratos' ) {\n             $sql .= \" ORDER BY precio ASC\";\n        } else {\n             $sql .= \" ORDER BY id DESC\";\n        }\n    }\n\n    \/\/ 3. L\u00cdMITE\n    $sql .= \" LIMIT \" . intval($a['limite']);\n\n    $libros = $wpdb->get_results( $sql );\n    \n    if ( empty( $libros ) ) return '';\n\n    ob_start();\n    ?>\n    \n    <style>\n        .contenedor-carrusel-mebook {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); \/* Responsivo autom\u00e1tico *\/\n            gap: 20px;\n            margin-bottom: 40px;\n        }\n        .tarjeta-libro {\n            background: white; border-radius: 15px; overflow: hidden;\n            box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: 0.3s;\n            border: 1px solid #eee;\n        }\n        .tarjeta-libro:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }\n        .imagen-libro { height: 250px; background-size: cover; background-position: center; }\n        .info-libro { padding: 15px; }\n        .info-libro h3 { font-size: 16px; margin: 0 0 5px 0; color: #002B5B; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\n        .precio-boton { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }\n        .precio { color: #28a745; font-weight: bold; }\n    <\/style>\n\n    <div class=\"contenedor-carrusel-mebook\">\n        <?php foreach ( $libros as $libro ) : ?>\n            <div class=\"tarjeta-libro\">\n                <a href=\"<?php echo home_url('\/detalle-libro\/'); ?>?id_libro=<?php echo $libro->id; ?>\" style=\"text-decoration:none; color:inherit;\">\n                    <div class=\"imagen-libro\" style=\"background-image: url('<?php echo esc_url($libro->imagen); ?>');\"><\/div>\n                    <div class=\"info-libro\">\n                        <h3 title=\"<?php echo esc_attr($libro->titulo); ?>\"><?php echo esc_html($libro->titulo); ?><\/h3>\n                        <p style=\"font-size:12px; color:#777; margin:0;\"><?php echo esc_html($libro->autor); ?><\/p>\n                        <div class=\"precio-boton\">\n                            <span class=\"precio\"><?php echo esc_html($libro->precio); ?> \ud83d\udc8e<\/span>\n                            <span style=\"font-size:12px; background:#f0f2f5; padding:5px 10px; border-radius:15px; color:#002B5B;\">Ver<\/span>\n                        <\/div>\n                    <\/div>\n                <\/a>\n            <\/div>\n        <?php endforeach; ?>\n    <\/div>\n    <?php\n    return ob_get_clean();\n}","active":true,"modified":"2025-12-16 01:40:17","revision":"1"}]}
