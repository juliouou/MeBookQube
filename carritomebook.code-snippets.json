{"generator":"Code Snippets v3.9.3","date_created":"2026-01-19 13:12","snippets":[{"id":8,"name":"CarritoMeBook","code":"\/\/ 1. INICIAR LA SESI\u00d3N (Memoria del navegador)\nadd_action( 'init', 'mebook_iniciar_sesion_carrito' );\nfunction mebook_iniciar_sesion_carrito() {\n    if ( ! session_id() ) {\n        session_start();\n    }\n    \/\/ Crear el carrito si no existe\n    if ( ! isset( $_SESSION['mebook_carrito'] ) ) {\n        $_SESSION['mebook_carrito'] = array();\n    }\n}\n\n\/\/ 2. DETECTAR CLICS (Agregar\/Quitar)\nadd_action( 'template_redirect', 'mebook_procesar_acciones_carrito' );\nfunction mebook_procesar_acciones_carrito() {\n    \/\/ A) AGREGAR AL CARRITO\n    if ( isset( $_POST['mebook_add_cart'] ) ) {\n        $id_libro = intval( $_POST['id_libro_oculto'] );\n        \n        \/\/ Evitar duplicados\n        if ( ! in_array( $id_libro, $_SESSION['mebook_carrito'] ) ) {\n            $_SESSION['mebook_carrito'][] = $id_libro;\n            wc_add_notice( '\u2705 Libro agregado al carrito.', 'success' ); \/\/ Usa estilos de woo si existe, sino alerta simple\n        }\n    }\n\n    \/\/ B) ELIMINAR DEL CARRITO\n    if ( isset( $_GET['borrar_item'] ) ) {\n        $id_borrar = intval( $_GET['borrar_item'] );\n        $key = array_search( $id_borrar, $_SESSION['mebook_carrito'] );\n        if ( false !== $key ) {\n            unset( $_SESSION['mebook_carrito'][$key] );\n             \/\/ Reordenar array\n             $_SESSION['mebook_carrito'] = array_values( $_SESSION['mebook_carrito'] );\n        }\n    }\n\n    \/\/ C) VACIAR CARRITO\n    if ( isset( $_POST['vaciar_carrito'] ) ) {\n        $_SESSION['mebook_carrito'] = array();\n    }\n}\n\n\/\/ 3. SHORTCODE PARA MOSTRAR EL ICONO FLOTANTE (Opcional)\nadd_shortcode( 'mebook_icono_carrito', 'mostrar_icono_carrito' );\nfunction mostrar_icono_carrito() {\n    $count = count( $_SESSION['mebook_carrito'] );\n    return '<a href=\"'.home_url('\/carrito').'\" class=\"icono-carrito-flotante\">\ud83d\uded2 <span class=\"badge\">'.$count.'<\/span><\/a>';\n}","active":true,"modified":"2025-12-16 00:32:46","revision":"1"}]}